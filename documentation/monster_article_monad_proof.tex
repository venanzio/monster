
\begin{definition}\label{def:monad}
For an endofunctor $T$ on a category $C$, a {\em monad} is a triple $(T, \mu, \eta)$, of $T$ and two natural transformations $\mu : TT \Rightarrow T$ and $\eta : 1_C \Rightarrow T$ ($1_C$ being the identity functor on $C$) such that these diagrams commute:
$$
\setlength\arraycolsep{30pt}
\begin{array}{cc} \ \\
\Rnode{t1}{TA} & \Rnode{tt}{TTA} \\[30pt]
 & \Rnode{t2}{TA} \\ \ 
\end{array}
\psset{nodesep=5pt,arrows=->}
\ncline{t1}{tt} \taput{\eta_{TA}}
\ncline{tt}{t2} \trput{\mu}
\ncline{t1}{t2} \tbput{id_{TA}}
\qquad 
\setlength\arraycolsep{30pt}
\begin{array}{cc} \ \\
\Rnode{t1}{TA} & \Rnode{tt}{TTA} \\[30pt]
 & \Rnode{t2}{TA} \\ \ 
\end{array}
\psset{nodesep=5pt,arrows=->}
\ncline{t1}{tt} \taput{T\eta_{A}}
\ncline{tt}{t2} \trput{\mu}
\ncline{t1}{t2} \tbput{id_{TA}}
$$
$$
\setlength\arraycolsep{30pt}
\begin{array}{cc} \ \\
\Rnode{ttt}{TTTA} & \Rnode{tt1}{TTA} \\[30pt]
\Rnode{tt2}{TTA} & \Rnode{t}{TA} \\ \ 
\end{array}
\psset{nodesep=5pt,arrows=->}
\ncline{ttt}{tt1} \taput{\mu T}
\ncline{ttt}{tt2} \tlput{T\mu}
\ncline{tt2}{t} \tbput{\mu}
\ncline{tt1}{t} \trput{\mu}
$$
\end{definition}

For the functor $\stream{M}$ to be a monad, the monad laws (these commuting diagrams) need to be satisfied. However, assuming a monad $(\stream{M}, \mu, \eta)$, the left identity law (top-left diagram) does not hold in general, given an arbitrary underlying monad $M$. This is due to a correct $\mu$ not being constructible.\\

Here, subscripts of $\eta$ (and $\mu$) indicate their monad, and not components of the natural transformation - these are instead indicated using function application: $\eta_M(x)$ where $x : A$ implies that we are using the component of $\eta_M$ at $A$. \\

First, note that $\eta_{\stream{M}}$ has to be defined as:

$$\eta_{\stream{M}}(x) = mcons_M(\eta_M ((x, \eta_{\stream{M}}(x)))$$ 

There is one choice of $A$ for the first element of the pair, and only one way of lifting pairs into the inner monad $M$, which is by using $\eta_M$. The second element of the pair has to be a $\stream{M,A}$, and the only way to produce this here is by a recursive call.\\

We introduce the notation $\mathop{|}_M^i$ to denote a monadic stream constructor guarded by a monadic action $m_i : A \to MA$. Since each monadic action in $M$ may be different, $i$ is just a label to indicate when they are the same. That is, for any $i$, and a fixed $a : A$:
\begin{align*}
&s_0 : \stream{M,A} = \mathop{|}_M^i a, s_0\\
&s_1 : \stream{M,A} = \mathop{|}_M^i a, s_1\\
&s_0 = s_1
\end{align*}
If $i = \eta$, this monadic action is the monad $M$'s unit, the natural transformation $\eta_M$. For any other label $i$, the monadic action is arbitrary. If there is no label, whether the monadic actions are equal is not being considered.\\

\begin{proof}
If $(\stream{M}, \mu, \eta)$ is a monad, then it needs to obey the left identity law, which in this case is
$$
\mu_{\stream{M}}(\eta_{\stream{M}}(s)) = s
\qquad s : \stream{M,A}
$$
For an arbitrary steam $s$, defined as:
$$
s = \mathop{|}_M^0 a_0, \mathop{|}_M^1 a_1, \mathop{|}_M^2  a_2, \dots
$$
First we construct the $M$-monster of $M$-monsters (termed an $M$-matrix) as per this requirement:
\begin{align*}
&\eta_{\stream{M}}(s) : \stream{M,\stream{M,A}} = \mathop{|}_M^\eta s, \mathop{|}_M^\eta s, \mathop{|}_M^\eta s, \dots
\end{align*}
To take the diagonal, you have to take the first element of the first stream, the second of the second stream, and so on. The law says that $\eta_{\stream{M}}(s)$ needs to be somehow manipulated to form $s$. \\

We reason that $\mu_{\stream{M}}$ cannot be constructed by noting that there is no function out of a monad in general (no function $f : MA \to A$ for an arbitrary functor M over which a monad is defined), and then traversing the $M$-matrix to see which monadic actions \emph{necessarily} have to guard each element in the $M$-monster resulting from an application of $\mu_{\stream{M}}$ to $\eta_{\stream{M}}(s)$.\\

Observe that the first element of the first stream $a_0$ in $\eta_{\stream{M,A}}(s)$ is guarded by two monadic actions, one of them $\eta$, the other an arbitrary action, which we'll call $m_0 : MA$. By the left identity on the monad $M$, $\mu(\eta(m_0)) = m_0$, which indicates that in the absolute best case, the first element of the $M$-monster is guarded by $m_0$.
$$
\eta_{\stream{M}}(s) : \stream{M,\stream{M,A}} = \mathop{|}_M^\eta (\mathop{|}_M^0 \stackrel{\downarrow}{a_0}, \mathop{|}_M^1 a_1, \dots), \mathop{|}_M^\eta s, \dots
$$
Here, "best case" refers to the minimum sequence of monadic actions you have to evaluate to get to a certain element in the stream, removing $\eta$ actions where possible as they act as a unit for Kleisli composition.

Now that we know the first element of the resulting stream $a_0$ will be, in the best case, guarded by $m_0$, we look at what actions guard the second element $a_1$. WLOG, there are two ways to extract $a_1$, either by taking the second element of the second $M$-monster, or by taking the second element of the first $M$-monster. This gives two cases to consider.\\

\paragraph{Case 1:}

In the first case: if we take the second element of the second $M$-monster, then we have to consider what actions guard the element $a_1$ - these in order are $\eta, \eta, m_0, m_1$, obtained by traversing along $\eta_{\stream{M}}(s)$ to the second $s$, and then along $s$ to $a_1$. By using the left identity again, this could reduce in the best case to $m_0(m_1(a_1))$.

$$
\eta_{\stream{M}}(s) : \stream{M,\stream{M,A}} = \mathop{|}_M^\eta s, \mathop{|}_M^\eta (\mathop{|}_M^0 a_0, \mathop{|}_M^1 \stackrel{\downarrow}{a_1}, \dots), \dots
$$

Now realise that in $s$, the element $a_0$ comes before $a_1$. This means that any monadic actions guarding $a_0$, have to also guard $a_1$. Crucially, the $m_0$ actions that guard them \emph{are not the same}, one comes from the first $s$, and the other from the second $s$. This means $a_1$ has to be guarded by \emph{two copies} of $m_0$ - one from the $s$ in the first index of $\eta_{\stream{M}}(s)$ (which is required to guard $a_0$), and one from the second. 

As you cannot get rid of this extra monadic action in general, $s$ is not constructible from $\eta_{\stream{M}}(s)$ in this way. The problem with a duplicated monadic action can be demonstrated with the State monad - if you have an action that adds $3$ to an underlying state, duplicating this would produce an overall action of adding $6$.\\


\paragraph{Case 2:} 

The second case to consider was to take the second element from the first stream. To show this doesn't work generally either, we have to instead consider the right monad identity law. This states that:

$$
\mu_{\stream{M}}(\stream{M}\eta_{\stream{M}}(s)) = s
\qquad s : \stream{M,A}
$$

Where $\stream{M}\eta_{\stream{M}}$ lifts $\eta_{\stream{M}}$ to a function on monadic streams, which effectively applies it to each of the elements (this is our \verb+fmap+ definition from earlier). We redefine the $M$-matrix accordingly:
\begin{align*}
&a_i : A\\
&\eta_{\stream{M}}(a_i) : \stream{M,A} = \mathop{|}_M^\eta a_i, \mathop{|}_M^\eta a_i, \mathop{|}_M^\eta  a_i, \dots\\
&\stream{M}\eta_{\stream{M}}(s) : \stream{M,\stream{M,A}} = \mathop{|}_M^0 \eta_{\stream{M}}(a_0), \mathop{|}_M^1 \eta_{\stream{M}}(a_1), \mathop{|}_M^2 \eta_{\stream{M}}(a_2), \dots
\end{align*}

Using similar logic to before, you can show that $a_0$ is guarded by at least $m_0$. However, if you pick the second element from the second stream, you get another $a_0$. The $\mu_{\stream{M,A}}$ operation has to cross over to the next 'sub-monster' $\eta_{\stream{M}}(a_1)$ to get the value $a_1$. This loops us back to the first case, where we show that doing this causes a duplication of monadic actions, considering the left identity. 

\end{proof}